<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>zip images video player by nghehuavan</title>
</head>

<body>
    <div id="url">https://raw.githubusercontent.com/nghehuavan/assets/main/glamo/sample.zip</div>
    <button onclick="readFile()">play</button>
    <div> <canvas id="video" width="640" height="480"></canvas></div>

    <script type="text/javascript" src="unzip.min.js"></script>
    <script>
        var canvas = document.getElementById("video");
        const context = canvas.getContext('2d');
        let assets = [];
        function showImagesLikeVideo(index) {
            if (index < assets.length) {
                context.drawImage(assets[index], 0, 0);
                setTimeout(showImagesLikeVideo.bind(null, index + 1), 200);
            }
        }

        const readFile = async () => {
            const zipUrl = 'https://raw.githubusercontent.com/nghehuavan/assets/main/glamo/sample.zip'
            const response = await fetch(zipUrl)
            const arrayBuffer = await response.arrayBuffer()
            const uint8Array = new Uint8Array(arrayBuffer);
            console.log(uint8Array)

            var unzip = new Zlib.Unzip(uint8Array);
            var fileNames = unzip.getFilenames();

            // console.log(fileNames)

            const images = fileNames.map(fileName => {
                var utf8Array = unzip.decompress(fileName)
                var base64 = btoa(String.fromCharCode.apply(null, utf8Array));
                const img = new Image()
                img.src = "data:image/jpeg;base64," + base64;
                return img;
            })
            assets = [];
            assets.push(...images)

            setTimeout(showImagesLikeVideo(0), 1000);
        }
    </script>

</body>

</html>