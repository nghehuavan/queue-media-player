<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>image video player by nghehuavan</title>
</head>

<body>
    <div id="url">https://raw.githubusercontent.com/nghehuavan/assets/main/glamo/sample.zip</div>
    <button onclick="unzip()">play</button>
    <div> <canvas id="video" width="640" height="480"></canvas></div>

    <script type="text/javascript" src="unzip.min.js"></script>
    <script>
        var canvas = document.getElementById("video");
        const context = canvas.getContext('2d');
        const assets = [];
        function showImagesLikeVideo(index) {
            if (index < assets.length) {
                context.drawImage(assets[index], 0, 0);
                setTimeout(showImagesLikeVideo.bind(null, index + 1), 200);
            }
        }

        const zipUrl = 'https://raw.githubusercontent.com/nghehuavan/assets/main/glamo/sample.zip'
        const unzip = async () => {
            const res = await fetch(
                zipUrl,
            )
            const data = await res.arrayBuffer()

            extractAndPlay(new Blob([data]));
        }

        function extractAndPlay(fileBlob) {
            var zipReader = new FileReader();
            zipReader.onload = function () {
                try {
                    var zipArr = new Uint8Array(zipReader.result);
                    var unzip = new Zlib.Unzip(zipArr);
                    var fileNames = unzip.getFilenames();
                    fileNames.forEach(fileName => {
                        var utf8Array = unzip.decompress(fileName)
                        var base64 = btoa(String.fromCharCode.apply(null, utf8Array));
                        const img = new Image()
                        img.src = "data:image/jpeg;base64," + base64;
                        assets.push(img)
                    });

                    setTimeout(showImagesLikeVideo(0), 5000);
                } catch (e) {
                    console.log(e.message);
                }
            }
            zipReader.readAsArrayBuffer(fileBlob);
        }        
    </script>

</body>

</html>